<!-- $Id: rand_run_ord.htm 5310 2009-01-10 07:57:56Z hami $ -->
{{include file=$this->header_tpl}}

{{if $this->Info!='' && $smarty.get.act=='ord'}} 
<tr bgcolor="#FFFFFF"><td colspan=2>
<FORM METHOD=POST ACTION='{{$smarty.server.PHP_SELF}}' Name='f1' >
<table  border='0' align='center' cellpadding='5' cellspacing='1' width="100%" bgcolor='#FFCC33' style='font-size:14pt'>
<tr>
<td width="100%" colspan="2" align='center'><H3>電腦亂數編班--班序調整</H3></td>
</tr>
<tr bgcolor=white align='center'>
<td>作業名稱</td>
<td>□<font color="#0000FF"><b>{{$this->Info.Rand.rWord.Y}}</b>學年度 第<b>
{{$this->Info.Rand.rWord.S}}</b>學期
<b>{{$this->Info.Rand.rWord.Gw}}</b> 學生 亂數編班作業</font>
</td>

</tr>
<tr bgcolor=white align='center'>
<td>班級數</td>
<td>
{{foreach item=arr from=$this->New.k1}}
班序: {{$arr}} ===改為===> 班序: 
<input type="text" name="Ordclass[{{$arr}}]" value="{{$arr}}" size=4 id='Ord' style="font-weight: bold; color:red;font-size:16pt;text-align:center;">
<br>
{{/foreach}}
</td>
</tr>
<tr bgcolor=white>
<td colspan=2 align='center' >
<INPUT TYPE='hidden' Name='form_act' Value=''>
<INPUT TYPE='hidden' Name='Fi' Value='{{$this->Fi}}'>
<INPUT TYPE='hidden' Name='step' Value='{{$this->mod}}'>
<INPUT TYPE='button' value='亂數調整' onclick="RRR()">
<INPUT TYPE='button' value='寫入資料' onclick="if( window.confirm('寫入班序了喔？確定嗎？')){f1.form_act.value='startOrd';f1.submit();}">
</FORM>
</td>
</tr>
</table>
</FORM>
</td></tr>
{{/if}}



</table><br>

<script LANGUAGE="JavaScript" TYPE="text/javascript">
	function shuffle(v){
		for(var j, x, i = v.length; i; j = parseInt(Math.random() * i), x = v[--i], v[i] = v[j], v[j] = x);
		return v;
	} 

function RRR() {
	var X = new Array({{$this->New.k2}});
	var Y = new Array({{$this->New.k2}});
	X=shuffle(X);
//	alert(X);
//	var Z=document.getElementById("Ord");
//	var Z=document.f1.elements;//document.f1.element;
	var i=0;a=1;b=0;
	while (i < document.f1.elements.length) {
		Z=document.f1.elements[i];
		var obj_chk="Ordclass["+a+"]";
		if (Z.name==obj_chk ) {
			Z.value=X[b];
			a++;b++;
		}
		i++;
	}
		
}

</script>